#include "PointerMap.h"
#include "MemoryManager.h"

DWORD health;
DWORD maxHealth;
DWORD mana;
DWORD maxMana;
DWORD target;
DWORD protectionZone;
DWORD speed;
DWORD baseSpeed;
DWORD cooldownF1;
DWORD cooldownF2;
DWORD cooldownF3;
DWORD cooldownF4;
DWORD cooldownF5;
DWORD cooldownF6;
DWORD cooldownF7;
DWORD cooldownF8;
DWORD cooldownF9;
DWORD cooldownF10;
DWORD cooldownF11;
DWORD cooldownF12;
DWORD cooldownAttack;
DWORD buff;
DWORD positionX;
DWORD positionY;
DWORD positionZ;
DWORD zoom;
DWORD battleCount;
DWORD direction;

void PointerMap::initializePointers(HANDLE processHandle, DWORD pID)
{
    DWORD THREADSTACK0 = getThreadBaseAddress(0, pID, processHandle);
    DWORD MAGEOTMODULE = dwGetModuleBaseAddress(PROCESS_NAME, pID);

    health = readMemoryPointer(processHandle, { THREADSTACK0 - 0x114, 0xCC, 0x4, 0x118, 0x4C, 0x18, 0x38, 0x18, 0x10, 0x10 });
    maxHealth = readMemoryPointer(processHandle, { THREADSTACK0 - 0x114, 0x1DC, 0x40, 0x18, 0x38, 0x4, 0x10, 0x0, 0x1C, 0x5B8 });
    mana = readMemoryPointer(processHandle, { THREADSTACK0 - 0x114, 0x1DC, 0x40, 0x18, 0x24, 0x38, 0x18, 0x0, 0x98, 0x6B0 });
    maxMana = readMemoryPointer(processHandle, { THREADSTACK0 - 0x114, 0x1DC, 0x40, 0x18, 0x38, 0x4, 0x10, 0x0, 0x94, 0x6D8 });
    target = readMemoryPointer(processHandle, { THREADSTACK0 - 0x114, 0x1D4, 0x5C, 0xB8, 0x1C, 0x1C, 0x144, 0x28 });
    protectionZone = readMemoryPointer(processHandle, { THREADSTACK0 - 0x114, 0x130, 0x48, 0x20, 0x4, 0x4, 0x74, 0x0, 0x4, 0x55 });
    speed = readMemoryPointer(processHandle, { THREADSTACK0 - 0x114, 0x1BC, 0x28, 0x41C, 0xC, 0x14, 0x10, 0x2A0, 0xC, 0x78 });
    baseSpeed = readMemoryPointer(processHandle, { THREADSTACK0 - 0x114, 0x1BC, 0x28, 0x41C, 0xC, 0x14, 0x10, 0x2A0, 0xC, 0x7A });
    cooldownF1 = readMemoryPointer(processHandle, { THREADSTACK0 - 0x114, 0x4, 0x4, 0x1E4, 0x4C, 0x0, 0x70, 0x0, 0x0, 0x48 });
    cooldownF2 = readMemoryPointer(processHandle, { THREADSTACK0 - 0x114, 0x4, 0x4, 0x1E4, 0x4C, 0x0, 0x70, 0x8, 0x0, 0x48 });
    cooldownF3 = readMemoryPointer(processHandle, { THREADSTACK0 - 0x114, 0x4, 0x4, 0x1E4, 0x4C, 0x0, 0x70, 0x14, 0x0, 0x48 });
    cooldownF4 = readMemoryPointer(processHandle, { THREADSTACK0 - 0x114, 0x4, 0x4, 0x1E4, 0x4C, 0x0, 0x70, 0x1C, 0x0, 0x48 });
    cooldownF5 = readMemoryPointer(processHandle, { THREADSTACK0 - 0x114, 0x4, 0x4, 0x1E4, 0x4C, 0x0, 0x70, 0x20, 0x0, 0x48 });
    cooldownF6 = readMemoryPointer(processHandle, { THREADSTACK0 - 0x114, 0x4, 0x4, 0x1E4, 0x4C, 0x0, 0x70, 0x28, 0x0, 0x48 });
    cooldownF7 = readMemoryPointer(processHandle, { THREADSTACK0 - 0x114, 0x4, 0x4, 0x1E4, 0x4C, 0x0, 0x70, 0x30, 0x0, 0x48 });
    cooldownF8 = readMemoryPointer(processHandle, { THREADSTACK0 - 0x114, 0x4, 0x4, 0x1E4, 0x4C, 0x0, 0x70, 0x38, 0x0, 0x48 });
    cooldownF9 = readMemoryPointer(processHandle, { THREADSTACK0 - 0x114, 0x4, 0x4, 0x1E4, 0x4C, 0x0, 0x70, 0x40, 0x0, 0x48 });
    cooldownF10 = readMemoryPointer(processHandle, { THREADSTACK0 - 0x114, 0x4, 0x4, 0x1E4, 0x4C, 0x0, 0x70, 0x48, 0x0, 0x48 });
    cooldownF11 = readMemoryPointer(processHandle, { THREADSTACK0 - 0x114, 0x4, 0x4, 0x1E4, 0x4C, 0x0, 0x70, 0x50, 0x0, 0x48 });
    cooldownF12 = readMemoryPointer(processHandle, { THREADSTACK0 - 0x114, 0x4, 0x4, 0x1E4, 0x4C, 0x0, 0x70, 0x58, 0x0, 0x48 });
    cooldownAttack = readMemoryPointer(processHandle, { THREADSTACK0 - 0x114, 0x4, 0x4, 0x1E4, 0x4C, 0x0, 0x70, 0x70, 0x0, 0x48 });
    buff = readMemoryPointer(processHandle, { MAGEOTMODULE + 0xEA38D4, 0x4, 0x24, 0x0, 0x34, 0x4, 0x74, 0x78, 0x58, 0x18 });
    positionX = readMemoryPointer(processHandle, { THREADSTACK0 - 0x114, 0xCC, 0x4, 0x1DC, 0x3C, 0x38, 0x14, 0x10, 0x0, 0x150 });
    positionY = readMemoryPointer(processHandle, { THREADSTACK0 - 0x114, 0xCC, 0x4, 0x1DC, 0x3C, 0x38, 0x14, 0x10, 0x0, 0x154 });
    positionZ = readMemoryPointer(processHandle, { THREADSTACK0 - 0x114, 0xCC, 0x4, 0x1DC, 0x3C, 0x38, 0x14, 0x10, 0x0, 0x158 });
    zoom = readMemoryPointer(processHandle, { THREADSTACK0 - 0x114, 0x1DC, 0x38, 0xAC, 0x8, 0x4, 0x7C, 0x28, 0x7C });
    battleCount = readMemoryPointer(processHandle, { THREADSTACK0 - 0x114, 0x1D4, 0xE0, 0xC4, 0x38, 0x44, 0x4, 0x8, 0x64 });
    direction = readMemoryPointer(processHandle, { THREADSTACK0 - 0x114, 0x1B4, 0x3C, 0xC, 0x0, 0x4, 0x1C, 0x70, 0x10, 0x40 });
}

vec3 getDirectionOffset(int direction)
{
    if (direction == DIRECTION_NORTH)
        return { 0, -1, 0 };
    else if (direction == DIRECTION_EAST)
        return { 1, 0, 0 };
    else if (direction == DIRECTION_SOUTH)
        return { 0, 1, 0 };
    else // WEST
        return { -1, 0, 0 };
}